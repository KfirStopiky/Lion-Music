/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Renderer2, ElementRef, ViewChild, Input, HostListener } from '@angular/core';
import { NgxImgZoomService } from './ngx-img-zoom.service';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from './ngx-img-zoom.service';
import * as ɵngcc2 from './mouse-wheel.directive';
import * as ɵngcc3 from '@angular/common';

const _c0 = ["img"];
const _c1 = ["result"];
const _c2 = ["container"];
const _c3 = function (a0) { return { "hide": a0 }; };
export class NgxImgZoomComponent {
    /**
     * @param {?} renderer
     * @param {?} ngxZoomService
     */
    constructor(renderer, ngxZoomService) {
        this.renderer = renderer;
        this.ngxZoomService = ngxZoomService;
        this.hide = true;
        this._triggerAnimationIn = false;
        this.notFirstTime = false;
        this.showResult = false;
        this.zoomIndex = 0;
        this.zoomMode = this.ngxZoomService.zoomMode;
        this.enableZoom = false;
        this.zoomBreakPoints = this.ngxZoomService.zoomBreakPoints;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set imgStyle(val) {
        this._imgStyle = val;
    }
    /**
     * @return {?}
     */
    get imgStyle() {
        return this._imgStyle;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set resultStyle(val) {
        this._resultStyle = val;
    }
    /**
     * @return {?}
     */
    get resultStyle() {
        return this._resultStyle;
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set lensStyle(val) {
        this._lensStyle = val;
        if (this.notFirstTime) {
            this.imageZoom();
        }
    }
    /**
     * @return {?}
     */
    get lensStyle() {
        return this._lensStyle;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onscroll(event) {
        this.hide = true;
        this.renderer.setStyle(this.lens, 'visibility', 'hidden');
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onclick(event) {
        this.hide = true;
        this.renderer.setStyle(this.lens, 'visibility', 'hidden');
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set _imgSrc(val) {
        this.zoomImage = val;
        if (this.notFirstTime === true) {
            this.renderer.setStyle(this.result, 'backgroundImage', "url('" + val + "')");
        }
        this.notFirstTime = true;
        // this.renderer.setStyle(this.result, 'backgroundImage', val);
    }
    /**
     * @param {?} val
     * @return {?}
     */
    set _zoomImage(val) {
        this.previewImage = val;
        this.showResult = false;
        /** @type {?} */
        const image = new Image();
        image.src = this.zoomImage;
        image.onload = (/**
         * @return {?}
         */
        () => {
            this.showResult = true;
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    handleZoomOutOnMouseWheelUp() {
        if (this.enableZoom) {
            if (this.zoomBreakPoints.length - 1 > this.zoomIndex) {
                this.zoomIndex++;
            }
            this.lensStyle = `height: ${this.zoomBreakPoints[this.zoomIndex].h}px; width: ${this.zoomBreakPoints[this.zoomIndex].w}px;`;
            this.imageZoom();
            this.moveLens(this.lastEventBeforeTheWheel); // Called to keep the position of the lens unchanged.
        }
    }
    /**
     * @return {?}
     */
    handleZoomInOnMouseWheelUp() {
        if (this.enableZoom) {
            if (this.zoomIndex > 0) {
                this.zoomIndex--;
            }
            this.lensStyle = `height: ${this.zoomBreakPoints[this.zoomIndex].h}px; width: ${this.zoomBreakPoints[this.zoomIndex].w}px;`;
            this.imageZoom();
            this.moveLens(this.lastEventBeforeTheWheel); // Called to keep the position of the lens unchanged.
        }
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.img = this.imgElmRef.nativeElement;
        this.result = this.resultElmRef.nativeElement;
        this.container = this.containerElmRef.nativeElement;
        this.renderer.setAttribute(this.img, 'style', (/** @type {?} */ (this.imgStyle)));
        this.renderer.setAttribute(this.result, 'style', (/** @type {?} */ (this.resultStyle)));
        this.renderer.setAttribute(this.container, 'style', (/** @type {?} */ (this.containerStyle)));
        this.imageZoom();
        /*execute a function when someone moves the cursor over the image, or the lens:*/
        this.lensMouseMoveListener = this.renderer.listen(this.lens, 'mousemove', this.moveLens.bind(this));
        this.imgMouseMoveListener = this.renderer.listen(this.img, 'mousemove', this.moveLens.bind(this));
        /*and also for touch screens:*/
        this.imgTouchMoveListener = this.renderer.listen(this.img, 'touchmove', this.moveLens.bind(this));
        this.lensTouchMoveListener = this.renderer.listen(this.lens, 'touchmove', this.moveLens.bind(this));
        this.renderer.setStyle(this.lens, 'visibility', 'hidden');
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        this.lensMouseMoveListener && this.lensMouseMoveListener();
        this.imgMouseMoveListener && this.imgMouseMoveListener();
        this.imgTouchMoveListener && this.imgTouchMoveListener();
        this.lensTouchMoveListener && this.lensTouchMoveListener();
    }
    /**
     * @return {?}
     */
    imageZoom() {
        /*create lens:*/
        if (!this.lens) {
            this.lens = this.renderer.createElement('DIV');
            this.renderer.addClass(this.lens, 'img-zoom-lens');
            // this.renderer.addClass(this.lens, 'cursor-crosshair');
            this.renderer.insertBefore(this.img.parentElement, this.lens, this.img);
        }
        /*insert lens:*/
        this.renderer.setAttribute(this.lens, 'style', (/** @type {?} */ (this.lensStyle)));
        /*calculate the ratio between result DIV and lens:*/
        this.cx = this.result.offsetWidth / this.lens.offsetWidth;
        this.cy = this.result.offsetHeight / this.lens.offsetHeight;
        /*set background properties for the result DIV:*/
        this.renderer.setStyle(this.result, 'backgroundImage', "url('" + this.zoomImage + "')");
        this.renderer.setStyle(this.result, 'backgroundSize', (this.img.width * this.cx) + 'px ' + (this.img.height * this.cy) + 'px');
        // this.renderer.setStyle(this.img.parentElement, 'position', 'relative')
    }
    /**
     * @param {?} e
     * @return {?}
     */
    moveLens(e) {
        this.lastEventBeforeTheWheel = e;
        /** @type {?} */
        let pos;
        /** @type {?} */
        let x;
        /** @type {?} */
        let y;
        /*prevent any other actions that may occur when moving over the image:*/
        e.preventDefault();
        /*get the cursor's x and y positions:*/
        pos = this.getCursorPos(e);
        /*calculate the position of the lens:*/
        x = pos.x - (this.lens.offsetWidth / 2);
        y = pos.y - (this.lens.offsetHeight / 2);
        /*prevent the lens from being positioned outside the image:*/
        if (x > this.img.width - this.lens.offsetWidth) {
            x = this.img.width - this.lens.offsetWidth;
        }
        else if (x < 0) {
            x = 0;
        }
        if (y > this.img.height - this.lens.offsetHeight) {
            y = this.img.height - this.lens.offsetHeight;
        }
        else if (y < 0) {
            y = 0;
        }
        this.hide = false;
        if (this.showResult) {
            this.renderer.setStyle(this.lens, 'left', x + 'px');
            this.renderer.setStyle(this.lens, 'top', y + 'px');
            /*display what the lens 'sees':*/
            this.renderer.setStyle(this.result, 'backgroundPosition', '-' + (x * this.cx) + 'px -' + (y * this.cy) + 'px');
            this.renderer.setStyle(this.lens, 'visibility', 'visible');
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    getCursorPos(e) {
        /** @type {?} */
        let a;
        /** @type {?} */
        let x = 0;
        /** @type {?} */
        let y = 0;
        e = e || window.event;
        /*get the x and y positions of the image:*/
        a = this.img.getBoundingClientRect();
        /*calculate the cursor's x and y coordinates, relative to the image:*/
        x = e.pageX - a.left;
        y = e.pageY - a.top;
        /*consider any page scrolling:*/
        x = x - window.pageXOffset;
        y = y - window.pageYOffset;
        return { x: x, y: y };
    }
    /**
     * @return {?}
     */
    handleMouseLeave() {
        this.hide = true;
        this.renderer.setStyle(this.lens, 'visibility', 'hidden');
    }
}
NgxImgZoomComponent.ɵfac = function NgxImgZoomComponent_Factory(t) { return new (t || NgxImgZoomComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NgxImgZoomService)); };
NgxImgZoomComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: NgxImgZoomComponent, selectors: [["ngx-img-zoom"]], viewQuery: function NgxImgZoomComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, true);
        ɵngcc0.ɵɵviewQuery(_c1, true);
        ɵngcc0.ɵɵviewQuery(_c2, true);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.imgElmRef = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.resultElmRef = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.containerElmRef = _t.first);
    } }, hostBindings: function NgxImgZoomComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("scroll", function NgxImgZoomComponent_scroll_HostBindingHandler($event) { return ctx.onscroll($event); }, false, ɵngcc0.ɵɵresolveWindow)("click", function NgxImgZoomComponent_click_HostBindingHandler($event) { return ctx.onclick($event.target); }, false, ɵngcc0.ɵɵresolveWindow);
    } }, inputs: { enableZoom: "enableZoom", imgStyle: "imgStyle", resultStyle: "resultStyle", lensStyle: "lensStyle", _imgSrc: ["zoomImageSrc", "_imgSrc"], _zoomImage: ["previewImageSrc", "_zoomImage"], containerStyle: "containerStyle" }, decls: 6, vars: 4, consts: [[1, "img-zoom-container"], ["container", ""], ["id", "myimage", "libMouseWheel", "", 1, "cursor-crosshair", 3, "src", "mouseleave", "mouseWheelUp", "mouseWheelDown"], ["img", ""], ["id", "myresult", 1, "img-zoom-result", 3, "ngClass"], ["result", ""]], template: function NgxImgZoomComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0, 1);
        ɵngcc0.ɵɵelementStart(2, "img", 2, 3);
        ɵngcc0.ɵɵlistener("mouseleave", function NgxImgZoomComponent_Template_img_mouseleave_2_listener() { return ctx.handleMouseLeave(); })("mouseWheelUp", function NgxImgZoomComponent_Template_img_mouseWheelUp_2_listener() { return ctx.handleZoomInOnMouseWheelUp(); })("mouseWheelDown", function NgxImgZoomComponent_Template_img_mouseWheelDown_2_listener() { return ctx.handleZoomOutOnMouseWheelUp(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelement(4, "div", 4, 5);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("src", ctx.previewImage, ɵngcc0.ɵɵsanitizeUrl);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(2, _c3, ctx.hide || !ctx.showResult));
    } }, directives: [ɵngcc2.MouseWheelDirective, ɵngcc3.NgClass], styles: ["*[_ngcontent-%COMP%]{box-sizing:border-box}.img-zoom-container[_ngcontent-%COMP%]{position:absolute}.cursor-crosshair[_ngcontent-%COMP%]{cursor:crosshair}.img-zoom-lens[_ngcontent-%COMP%]{pointer-events:none;position:absolute;border:1px solid #d4d4d4;width:40px;height:40px}.img-zoom-result[_ngcontent-%COMP%]{border:1px solid #d4d4d4;width:300px;height:300px}.hide[_ngcontent-%COMP%]{visibility:hidden}"] });
/** @nocollapse */
NgxImgZoomComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: NgxImgZoomService }
];
NgxImgZoomComponent.propDecorators = {
    imgElmRef: [{ type: ViewChild, args: ['img', { static: false },] }],
    resultElmRef: [{ type: ViewChild, args: ['result', { static: false },] }],
    containerElmRef: [{ type: ViewChild, args: ['container', { static: false },] }],
    enableZoom: [{ type: Input }],
    imgStyle: [{ type: Input }],
    resultStyle: [{ type: Input }],
    lensStyle: [{ type: Input }],
    containerStyle: [{ type: Input }],
    onscroll: [{ type: HostListener, args: ['window:scroll', ['$event'],] }],
    onclick: [{ type: HostListener, args: ['window:click', ['$event.target'],] }],
    _imgSrc: [{ type: Input, args: ['zoomImageSrc',] }],
    _zoomImage: [{ type: Input, args: ['previewImageSrc',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NgxImgZoomComponent, [{
        type: Component,
        args: [{
                selector: 'ngx-img-zoom',
                template: "\n<div  class=\"img-zoom-container\" #container>\n    <img id=\"myimage\" class='cursor-crosshair' [src]=\"previewImage\" #img (mouseleave)=\"handleMouseLeave()\" \n\tlibMouseWheel (mouseWheelUp)=\"handleZoomInOnMouseWheelUp()\" (mouseWheelDown)=\"handleZoomOutOnMouseWheelUp()\">\n\n    <div [ngClass]=\"{'hide': hide || !showResult}\" \n        id=\"myresult\" \n        class=\"img-zoom-result\" \n        #result>\n    </div>\n</div>  ",
                styles: ["*{box-sizing:border-box}.img-zoom-container{position:absolute}.cursor-crosshair{cursor:crosshair}.img-zoom-lens{pointer-events:none;position:absolute;border:1px solid #d4d4d4;width:40px;height:40px}.img-zoom-result{border:1px solid #d4d4d4;width:300px;height:300px}.hide{visibility:hidden}"]
            }]
    }], function () { return [{ type: ɵngcc0.Renderer2 }, { type: ɵngcc1.NgxImgZoomService }]; }, { enableZoom: [{
            type: Input
        }], imgStyle: [{
            type: Input
        }], resultStyle: [{
            type: Input
        }], lensStyle: [{
            type: Input
        }], 
    /**
     * @param {?} event
     * @return {?}
     */
    onscroll: [{
            type: HostListener,
            args: ['window:scroll', ['$event']]
        }], 
    /**
     * @param {?} event
     * @return {?}
     */
    onclick: [{
            type: HostListener,
            args: ['window:click', ['$event.target']]
        }], _imgSrc: [{
            type: Input,
            args: ['zoomImageSrc']
        }], _zoomImage: [{
            type: Input,
            args: ['previewImageSrc']
        }], imgElmRef: [{
            type: ViewChild,
            args: ['img', { static: false }]
        }], resultElmRef: [{
            type: ViewChild,
            args: ['result', { static: false }]
        }], containerElmRef: [{
            type: ViewChild,
            args: ['container', { static: false }]
        }], containerStyle: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    NgxImgZoomComponent.prototype.img;
    /** @type {?} */
    NgxImgZoomComponent.prototype.lens;
    /** @type {?} */
    NgxImgZoomComponent.prototype.result;
    /** @type {?} */
    NgxImgZoomComponent.prototype.cx;
    /** @type {?} */
    NgxImgZoomComponent.prototype.cy;
    /** @type {?} */
    NgxImgZoomComponent.prototype.container;
    /** @type {?} */
    NgxImgZoomComponent.prototype.hide;
    /** @type {?} */
    NgxImgZoomComponent.prototype._triggerAnimationIn;
    /** @type {?} */
    NgxImgZoomComponent.prototype.notFirstTime;
    /** @type {?} */
    NgxImgZoomComponent.prototype.showResult;
    /** @type {?} */
    NgxImgZoomComponent.prototype.lastEventBeforeTheWheel;
    /** @type {?} */
    NgxImgZoomComponent.prototype.zoomBreakPoints;
    /** @type {?} */
    NgxImgZoomComponent.prototype.zoomIndex;
    /** @type {?} */
    NgxImgZoomComponent.prototype.lensMouseMoveListener;
    /** @type {?} */
    NgxImgZoomComponent.prototype.imgMouseMoveListener;
    /** @type {?} */
    NgxImgZoomComponent.prototype.imgTouchMoveListener;
    /** @type {?} */
    NgxImgZoomComponent.prototype.lensTouchMoveListener;
    /** @type {?} */
    NgxImgZoomComponent.prototype.zoomMode;
    /** @type {?} */
    NgxImgZoomComponent.prototype.imgElmRef;
    /** @type {?} */
    NgxImgZoomComponent.prototype.resultElmRef;
    /** @type {?} */
    NgxImgZoomComponent.prototype.containerElmRef;
    /** @type {?} */
    NgxImgZoomComponent.prototype.enableZoom;
    /** @type {?} */
    NgxImgZoomComponent.prototype._imgStyle;
    /** @type {?} */
    NgxImgZoomComponent.prototype._resultStyle;
    /** @type {?} */
    NgxImgZoomComponent.prototype._lensStyle;
    /** @type {?} */
    NgxImgZoomComponent.prototype.containerStyle;
    /** @type {?} */
    NgxImgZoomComponent.prototype.zoomImage;
    /** @type {?} */
    NgxImgZoomComponent.prototype.previewImage;
    /**
     * @type {?}
     * @private
     */
    NgxImgZoomComponent.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    NgxImgZoomComponent.prototype.ngxZoomService;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWltZy16b29tLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsibmd4LWltZy16b29tL2xpYi9uZ3gtaW1nLXpvb20uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFpQixLQUFLLEVBQUUsWUFBWSxFQUFhLE1BQU0sZUFBZSxDQUFDO0FBQ25JLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDOzs7Ozs7Ozs7O0FBTzNELE1BQU0sT0FBTyxtQkFBbUI7QUFBRztBQUFRO0FBQTJCO0FBRS9DO0FBQVEsSUFjN0IsWUFDVSxRQUFtQixFQUNuQixjQUFpQztBQUMxQyxRQUZTLGFBQVEsR0FBUixRQUFRLENBQVc7QUFBQyxRQUNwQixtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7QUFDN0MsUUFoQkUsU0FBSSxHQUFHLElBQUksQ0FBQztBQUNkLFFBQUUsd0JBQW1CLEdBQUcsS0FBSyxDQUFDO0FBQzlCLFFBQUUsaUJBQVksR0FBRyxLQUFLLENBQUM7QUFDdkIsUUFBRSxlQUFVLEdBQUcsS0FBSyxDQUFDO0FBQ3JCLFFBRUUsY0FBUyxHQUFHLENBQUMsQ0FBQztBQUNoQixRQWFJLGFBQVEsR0FBbUIsSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUM7QUFDNUQsUUFLYSxlQUFVLEdBQUcsS0FBSyxDQUFDO0FBQ2hDLFFBVk0sSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQztBQUNqRSxJQUFJLENBQUM7QUFDTDtBQUNPO0FBQXNCO0FBQW1CO0FBQVEsSUFRcEQsSUFBYSxRQUFRLENBQUMsR0FBRztBQUM3QixRQUFNLElBQUksQ0FBQyxTQUFTLEdBQUcsR0FBRyxDQUFDO0FBQzNCLElBQUksQ0FBQztBQUNMO0FBQVE7QUFDRjtBQUFRLElBRFYsSUFBSSxRQUFRO0FBQ2hCLFFBQU0sT0FBTyxJ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ZW5kZXJlcjIsIEVsZW1lbnRSZWYsIFZpZXdDaGlsZCwgQWZ0ZXJWaWV3SW5pdCwgSW5wdXQsIEhvc3RMaXN0ZW5lciwgT25EZXN0cm95IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ3hJbWdab29tU2VydmljZSB9IGZyb20gJy4vbmd4LWltZy16b29tLnNlcnZpY2UnO1xuaW1wb3J0IHsgTmd4SW1nWm9vbU1vZGUgfSBmcm9tICcuL21vZGUuZW51bSc7XG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3gtaW1nLXpvb20nLFxuICB0ZW1wbGF0ZVVybDogJy4vbmd4LWltZy16b29tLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbmd4LWltZy16b29tLmNvbXBvbmVudC5jc3MnXSxcbn0pXG5leHBvcnQgY2xhc3MgTmd4SW1nWm9vbUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICBpbWc7IGxlbnM7IHJlc3VsdDsgY3g7IGN5OyBjb250YWluZXI7XG4gIGhpZGUgPSB0cnVlO1xuICBfdHJpZ2dlckFuaW1hdGlvbkluID0gZmFsc2U7XG4gIG5vdEZpcnN0VGltZSA9IGZhbHNlO1xuICBzaG93UmVzdWx0ID0gZmFsc2U7XG4gIGxhc3RFdmVudEJlZm9yZVRoZVdoZWVsO1xuICB6b29tQnJlYWtQb2ludHM7XG4gIHpvb21JbmRleCA9IDA7XG5cbiAgbGVuc01vdXNlTW92ZUxpc3RlbmVyO1xuICBpbWdNb3VzZU1vdmVMaXN0ZW5lcjtcbiAgaW1nVG91Y2hNb3ZlTGlzdGVuZXI7XG4gIGxlbnNUb3VjaE1vdmVMaXN0ZW5lcjtcbiAgXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICBwcml2YXRlIG5neFpvb21TZXJ2aWNlOiBOZ3hJbWdab29tU2VydmljZVxuICAgICkge1xuICAgICAgdGhpcy56b29tQnJlYWtQb2ludHMgPSB0aGlzLm5neFpvb21TZXJ2aWNlLnpvb21CcmVha1BvaW50cztcbiAgICB9XG5cbiAgICB6b29tTW9kZTogTmd4SW1nWm9vbU1vZGUgPSB0aGlzLm5neFpvb21TZXJ2aWNlLnpvb21Nb2RlO1xuICAgIEBWaWV3Q2hpbGQoJ2ltZycsIHsgc3RhdGljOiBmYWxzZSB9KSBpbWdFbG1SZWY6IEVsZW1lbnRSZWY7XG4gICAgQFZpZXdDaGlsZCgncmVzdWx0JywgeyBzdGF0aWM6IGZhbHNlIH0pIHJlc3VsdEVsbVJlZjogRWxlbWVudFJlZjtcbiAgICBAVmlld0NoaWxkKCdjb250YWluZXInLCB7IHN0YXRpYzogZmFsc2UgfSkgY29udGFpbmVyRWxtUmVmOiBFbGVtZW50UmVmO1xuXG5cbiAgICBASW5wdXQoKSBlbmFibGVab29tID0gZmFsc2U7XG4gICAgX2ltZ1N0eWxlO1xuICAgIEBJbnB1dCgpIHNldCBpbWdTdHlsZSh2YWwpIHtcbiAgICAgIHRoaXMuX2ltZ1N0eWxlID0gdmFsO1xuICAgIH1cbiAgICBnZXQgaW1nU3R5bGUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faW1nU3R5bGU7XG4gICAgfVxuXG4gICAgX3Jlc3VsdFN0eWxlO1xuICAgIEBJbnB1dCgpIHNldCByZXN1bHRTdHlsZSh2YWwpIHtcbiAgICAgIHRoaXMuX3Jlc3VsdFN0eWxlID0gdmFsO1xuICAgIH1cbiAgICBnZXQgcmVzdWx0U3R5bGUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcmVzdWx0U3R5bGU7XG4gICAgfVxuXG4gICAgX2xlbnNTdHlsZTtcbiAgICBASW5wdXQoKSBzZXQgbGVuc1N0eWxlKHZhbCkge1xuICAgICAgdGhpcy5fbGVuc1N0eWxlID0gdmFsO1xuICAgICAgaWYgKHRoaXMubm90Rmlyc3RUaW1lKSB7XG4gICAgICAgIHRoaXMuaW1hZ2Vab29tKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGdldCBsZW5zU3R5bGUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGVuc1N0eWxlO1xuICAgIH1cbiAgICBASW5wdXQoKSBjb250YWluZXJTdHlsZTtcbiAgICB6b29tSW1hZ2U7XG4gICAgcHJldmlld0ltYWdlO1xuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpzY3JvbGwnLCBbJyRldmVudCddKSBvbnNjcm9sbChldmVudCkge1xuICAgIHRoaXMuaGlkZSA9IHRydWU7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmxlbnMsICd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICB9XG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpjbGljaycsIFsnJGV2ZW50LnRhcmdldCddKSBvbmNsaWNrKGV2ZW50KSB7XG4gICAgdGhpcy5oaWRlID0gdHJ1ZTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMubGVucywgJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7XG4gIH1cblxuICBASW5wdXQoJ3pvb21JbWFnZVNyYycpIHNldCBfaW1nU3JjKHZhbCkge1xuICAgIHRoaXMuem9vbUltYWdlID0gdmFsO1xuICAgIGlmICh0aGlzLm5vdEZpcnN0VGltZSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnJlc3VsdCwgJ2JhY2tncm91bmRJbWFnZScsIFwidXJsKCdcIiArIHZhbCArIFwiJylcIik7XG4gICAgfVxuICAgIHRoaXMubm90Rmlyc3RUaW1lID0gdHJ1ZTtcbiAgICAvLyB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMucmVzdWx0LCAnYmFja2dyb3VuZEltYWdlJywgdmFsKTtcbiAgfVxuXG4gIEBJbnB1dCgncHJldmlld0ltYWdlU3JjJykgc2V0IF96b29tSW1hZ2UodmFsKSB7XG4gICAgdGhpcy5wcmV2aWV3SW1hZ2UgPSB2YWw7XG4gICAgdGhpcy5zaG93UmVzdWx0ID0gZmFsc2U7XG4gICAgY29uc3QgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICBpbWFnZS5zcmMgPSB0aGlzLnpvb21JbWFnZTtcbiAgICBpbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICB0aGlzLnNob3dSZXN1bHQgPSB0cnVlO1xuICAgIH07XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgfVxuXG4gIGhhbmRsZVpvb21PdXRPbk1vdXNlV2hlZWxVcCgpIHtcbiAgICBpZiAodGhpcy5lbmFibGVab29tKSB7XG4gICAgICBpZiAodGhpcy56b29tQnJlYWtQb2ludHMubGVuZ3RoIC0gMSA+IHRoaXMuem9vbUluZGV4KSB7XG4gICAgICAgIHRoaXMuem9vbUluZGV4Kys7XG4gICAgICB9XG4gICAgICB0aGlzLmxlbnNTdHlsZSA9IGBoZWlnaHQ6ICR7dGhpcy56b29tQnJlYWtQb2ludHNbdGhpcy56b29tSW5kZXhdLmh9cHg7IHdpZHRoOiAke3RoaXMuem9vbUJyZWFrUG9pbnRzW3RoaXMuem9vbUluZGV4XS53fXB4O2A7XG4gICAgICB0aGlzLmltYWdlWm9vbSgpO1xuICAgICAgdGhpcy5tb3ZlTGVucyh0aGlzLmxhc3RFdmVudEJlZm9yZVRoZVdoZWVsKTsgLy8gQ2FsbGVkIHRvIGtlZXAgdGhlIHBvc2l0aW9uIG9mIHRoZSBsZW5zIHVuY2hhbmdlZC5cbiAgICB9XG4gIH1cblxuICBoYW5kbGVab29tSW5Pbk1vdXNlV2hlZWxVcCgpIHtcbiAgICBpZiAodGhpcy5lbmFibGVab29tKSB7XG4gICAgICBpZiAodGhpcy56b29tSW5kZXggPiAwKSB7XG4gICAgICAgIHRoaXMuem9vbUluZGV4LS07XG4gICAgICB9XG4gICAgICB0aGlzLmxlbnNTdHlsZSA9IGBoZWlnaHQ6ICR7dGhpcy56b29tQnJlYWtQb2ludHNbdGhpcy56b29tSW5kZXhdLmh9cHg7IHdpZHRoOiAke3RoaXMuem9vbUJyZWFrUG9pbnRzW3RoaXMuem9vbUluZGV4XS53fXB4O2A7XG4gICAgICB0aGlzLmltYWdlWm9vbSgpO1xuICAgICAgdGhpcy5tb3ZlTGVucyh0aGlzLmxhc3RFdmVudEJlZm9yZVRoZVdoZWVsKTsgLy8gQ2FsbGVkIHRvIGtlZXAgdGhlIHBvc2l0aW9uIG9mIHRoZSBsZW5zIHVuY2hhbmdlZC5cbiAgICB9XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5pbWcgPSB0aGlzLmltZ0VsbVJlZi5uYXRpdmVFbGVtZW50O1xuICAgIHRoaXMucmVzdWx0ID0gdGhpcy5yZXN1bHRFbG1SZWYubmF0aXZlRWxlbWVudDtcbiAgICB0aGlzLmNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWxtUmVmLm5hdGl2ZUVsZW1lbnQ7XG5cbiAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLmltZywgJ3N0eWxlJywgPHN0cmluZz50aGlzLmltZ1N0eWxlKTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLnJlc3VsdCwgJ3N0eWxlJywgPHN0cmluZz50aGlzLnJlc3VsdFN0eWxlKTtcbiAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLmNvbnRhaW5lciwgJ3N0eWxlJywgPHN0cmluZz50aGlzLmNvbnRhaW5lclN0eWxlKTtcbiAgICB0aGlzLmltYWdlWm9vbSgpO1xuICAgIFxuICAgIC8qZXhlY3V0ZSBhIGZ1bmN0aW9uIHdoZW4gc29tZW9uZSBtb3ZlcyB0aGUgY3Vyc29yIG92ZXIgdGhlIGltYWdlLCBvciB0aGUgbGVuczoqL1xuICAgIHRoaXMubGVuc01vdXNlTW92ZUxpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5sZW5zLCAnbW91c2Vtb3ZlJywgdGhpcy5tb3ZlTGVucy5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmltZ01vdXNlTW92ZUxpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5pbWcsICdtb3VzZW1vdmUnLCB0aGlzLm1vdmVMZW5zLmJpbmQodGhpcykpO1xuXG4gICAgLyphbmQgYWxzbyBmb3IgdG91Y2ggc2NyZWVuczoqL1xuICAgIHRoaXMuaW1nVG91Y2hNb3ZlTGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmltZywgJ3RvdWNobW92ZScsIHRoaXMubW92ZUxlbnMuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5sZW5zVG91Y2hNb3ZlTGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmxlbnMsICd0b3VjaG1vdmUnLCB0aGlzLm1vdmVMZW5zLmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmxlbnMsICd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1x0XG4gIH1cblxuICBuZ09uRGVzdHJveSgpe1xuICAgIHRoaXMubGVuc01vdXNlTW92ZUxpc3RlbmVyICYmIHRoaXMubGVuc01vdXNlTW92ZUxpc3RlbmVyKCk7XG4gICAgdGhpcy5pbWdNb3VzZU1vdmVMaXN0ZW5lciAmJiB0aGlzLmltZ01vdXNlTW92ZUxpc3RlbmVyKCk7XG4gICAgdGhpcy5pbWdUb3VjaE1vdmVMaXN0ZW5lciAmJiB0aGlzLmltZ1RvdWNoTW92ZUxpc3RlbmVyKCk7XG4gICAgdGhpcy5sZW5zVG91Y2hNb3ZlTGlzdGVuZXIgJiYgdGhpcy5sZW5zVG91Y2hNb3ZlTGlzdGVuZXIoKTtcbiAgfVxuXG4gIGltYWdlWm9vbSgpIHtcbiAgICAvKmNyZWF0ZSBsZW5zOiovXG4gICAgaWYgKCF0aGlzLmxlbnMpIHtcbiAgICAgIHRoaXMubGVucyA9IHRoaXMucmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMubGVucywgJ2ltZy16b29tLWxlbnMnKTtcbiAgICAgIC8vIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3ModGhpcy5sZW5zLCAnY3Vyc29yLWNyb3NzaGFpcicpO1xuICAgICAgdGhpcy5yZW5kZXJlci5pbnNlcnRCZWZvcmUodGhpcy5pbWcucGFyZW50RWxlbWVudCwgdGhpcy5sZW5zLCB0aGlzLmltZyk7XG4gICAgfVxuXG4gICAgLyppbnNlcnQgbGVuczoqL1xuICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMubGVucywgJ3N0eWxlJywgPHN0cmluZz50aGlzLmxlbnNTdHlsZSk7XG5cbiAgICAvKmNhbGN1bGF0ZSB0aGUgcmF0aW8gYmV0d2VlbiByZXN1bHQgRElWIGFuZCBsZW5zOiovXG4gICAgICB0aGlzLmN4ID0gdGhpcy5yZXN1bHQub2Zmc2V0V2lkdGggLyB0aGlzLmxlbnMub2Zmc2V0V2lkdGg7XG4gICAgICB0aGlzLmN5ID0gdGhpcy5yZXN1bHQub2Zmc2V0SGVpZ2h0IC8gdGhpcy5sZW5zLm9mZnNldEhlaWdodDtcblxuICAgIC8qc2V0IGJhY2tncm91bmQgcHJvcGVydGllcyBmb3IgdGhlIHJlc3VsdCBESVY6Ki9cbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMucmVzdWx0LCAnYmFja2dyb3VuZEltYWdlJywgXCJ1cmwoJ1wiICsgdGhpcy56b29tSW1hZ2UgKyBcIicpXCIpO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5yZXN1bHQsICdiYWNrZ3JvdW5kU2l6ZScsICh0aGlzLmltZy53aWR0aCAqIHRoaXMuY3gpICsgJ3B4ICcgKyAodGhpcy5pbWcuaGVpZ2h0ICogdGhpcy5jeSkgKyAncHgnKTtcbiAgICAvLyB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuaW1nLnBhcmVudEVsZW1lbnQsICdwb3NpdGlvbicsICdyZWxhdGl2ZScpXG5cbiAgICBcbiAgfVxuXG4gIG1vdmVMZW5zKGUpIHtcbiAgICB0aGlzLmxhc3RFdmVudEJlZm9yZVRoZVdoZWVsID0gZTtcbiAgICAgIGxldCBwb3MsIHgsIHk7XG4gICAgICAvKnByZXZlbnQgYW55IG90aGVyIGFjdGlvbnMgdGhhdCBtYXkgb2NjdXIgd2hlbiBtb3Zpbmcgb3ZlciB0aGUgaW1hZ2U6Ki9cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIC8qZ2V0IHRoZSBjdXJzb3IncyB4IGFuZCB5IHBvc2l0aW9uczoqL1xuICAgICAgcG9zID0gdGhpcy5nZXRDdXJzb3JQb3MoZSk7XG4gICAgICAvKmNhbGN1bGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIGxlbnM6Ki9cbiAgICAgIHggPSBwb3MueCAtICh0aGlzLmxlbnMub2Zmc2V0V2lkdGggLyAyKTtcbiAgICAgIHkgPSBwb3MueSAtICh0aGlzLmxlbnMub2Zmc2V0SGVpZ2h0IC8gMik7XG5cblxuICAgICAgLypwcmV2ZW50IHRoZSBsZW5zIGZyb20gYmVpbmcgcG9zaXRpb25lZCBvdXRzaWRlIHRoZSBpbWFnZToqL1xuICAgICAgaWYgKHggPiB0aGlzLmltZy53aWR0aCAtIHRoaXMubGVucy5vZmZzZXRXaWR0aCkge1xuICAgICAgICB4ID0gdGhpcy5pbWcud2lkdGggLSB0aGlzLmxlbnMub2Zmc2V0V2lkdGg7XG4gICAgICB9IGVsc2UgaWYgKHggPCAwKSB7XG4gICAgICAgIHggPSAwO1xuICAgICAgfSBcbiAgICAgICBpZiAoeSA+IHRoaXMuaW1nLmhlaWdodCAtIHRoaXMubGVucy5vZmZzZXRIZWlnaHQpIHtcbiAgICAgICAgeSA9IHRoaXMuaW1nLmhlaWdodCAtIHRoaXMubGVucy5vZmZzZXRIZWlnaHQ7XG4gICAgICB9IGVsc2UgaWYgKHkgPCAwICkge1xuICAgICAgICB5ID0gMDtcbiAgICAgIH0gXG4gICAgICB0aGlzLmhpZGUgPSBmYWxzZTtcbiAgICAgIGlmICh0aGlzLnNob3dSZXN1bHQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmxlbnMsICdsZWZ0JywgeCArICdweCcpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMubGVucywgJ3RvcCcsIHkgKyAncHgnKTtcbiAgICAgICAgLypkaXNwbGF5IHdoYXQgdGhlIGxlbnMgJ3NlZXMnOiovXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5yZXN1bHQsICdiYWNrZ3JvdW5kUG9zaXRpb24nLCAnLScgKyAoeCAqIHRoaXMuY3gpICsgJ3B4IC0nICsgKHkgKiB0aGlzLmN5KSArICdweCcpO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMubGVucywgJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICAgICAgfVxuICAgIH1cblxuICBnZXRDdXJzb3JQb3MoZSkge1xuICAgICAgbGV0IGEsIHggPSAwLCB5ID0gMDtcbiAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDtcbiAgICAgIC8qZ2V0IHRoZSB4IGFuZCB5IHBvc2l0aW9ucyBvZiB0aGUgaW1hZ2U6Ki9cbiAgICAgIGEgPSB0aGlzLmltZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIC8qY2FsY3VsYXRlIHRoZSBjdXJzb3IncyB4IGFuZCB5IGNvb3JkaW5hdGVzLCByZWxhdGl2ZSB0byB0aGUgaW1hZ2U6Ki9cbiAgICAgIHggPSBlLnBhZ2VYIC0gYS5sZWZ0O1xuICAgICAgeSA9IGUucGFnZVkgLSBhLnRvcDtcbiAgICAgIC8qY29uc2lkZXIgYW55IHBhZ2Ugc2Nyb2xsaW5nOiovXG4gICAgICB4ID0geCAtIHdpbmRvdy5wYWdlWE9mZnNldDtcbiAgICAgIHkgPSB5IC0gd2luZG93LnBhZ2VZT2Zmc2V0O1xuICAgICAgcmV0dXJuIHt4IDogeCwgeSA6IHl9O1xuICB9XG5cbiAgaGFuZGxlTW91c2VMZWF2ZSgpIHtcbiAgICB0aGlzLmhpZGUgPSB0cnVlO1xuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5sZW5zLCAndmlzaWJpbGl0eScsICdoaWRkZW4nKTtcbiAgfVxuXG59XG4iXX0=